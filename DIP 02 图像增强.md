# DIP 02 图像增强

> 图像增强是图像处理中最具吸引力的领域，目的是提高图像在特定应用领域的视觉质量。

[TOC]

## 1 概述

* 图像增强包括光滑、锐化、提取边缘、反转、去噪以及各种滤波等等处理。目的是经过处理后的图像更适合特定的应用（主要是主观的观察分析）。
* 没有通用的理论和方法，主观评价为主。
* 仍然有很多待解决的问题。
* 共有两大类算法：空间域和频率域。

## 2 空间域图像增强

> 直接对图像的像素进行操作。

### 2.1 基本关系式

$$
g(x,y)=T\big(f(x,y)\big)
$$

其中，

* $f(x,y)$ 为输入图像；
* $T$ 为算子，定义域是$(x,y)$的某个邻域；
* $T$ 可以对数个图像进行操作；
* 灰度变换：$(x,y)$的邻域为一个点时：$s=T(r)$

### 2.2 基本灰度变换

**预览：线性、对数、幂次 $s=T(r)$**

![1567470601460](/home/karl/.config/Typora/typora-user-images/1567470601460.png) 

**反转变换 $s=L-1-r$**

> 人眼的一个特点就是在背景相对光亮时对灰度层次有较好的分辨能力。

####  2.2.1 对数变换

$$
s = clog(1+r)\\
c为常数，r\geq0
$$

* 适合大范围的数据压缩。
* 任何具有对数函数曲线形状的变换都可以完成灰度的**压缩和扩展**功能。 

#### 2.2.2 幂次变换

$$
s=Cr^\gamma\\
c,\gamma为常数
$$

![1567471098750](/home/karl/.config/Typora/typora-user-images/1567471098750.png)

* 当幂指数     变化时，得到一系列不同的曲线，对应于不同效果的变换。这是和对数变换不同和方便的地方。

* 伽马校正

  > 大量的图像设备如捕捉卡、打印机、数码相机以及显示装置的响应（输出）就对应一个幂函数，通常称这个幂函数的指数为“伽玛”（gamma）。纠正这个幂次响应的处理称为伽玛校正（gamma correction）。阴极射线管（CRT）装置中有一个电压-强度响应，这个响应就是指数γ变换范围在1.8~2.5的幂函数。 

* 幂函数还可以用于调整图像对比度。
* 如果图像偏暗，有些低灰度值的细节被掩盖时，可考虑用指数$\gamma<1$的伽玛校正；反之，$\gamma>1$的校正对那些被“漂白”的细节会起作用。

### 2.3 图像直方图

#### 2.3.1 概述

* 灰度级别：$[0,L-1]$

* 数字图像直方图是离散函数$h(r_k)=n_k$，其中$r_k$是第$k$级灰度，$n_k$是图像中灰度级为$k$的像素个数。

* 如果用图像中的像素总数（用n来表示）除它的每一个值，就得到一个归一化的直方图：
  $$
  P(r_k)=\dfrac{n_k}{n}\\
  0\leq P(r_k)\leq1\\
  且\sum_k P(r_k)=1,k=0,1,...,L-1
  $$
  

* 灰度直方图表示数字图像中每一个灰度级与其出现频数的统计关系。

#### 2.3.2 直方图均衡化

* 图像视觉质量和图像直方图的关系

  ![1567473036130](/home/karl/.config/Typora/typora-user-images/1567473036130.png) 四种基本图像类型：暗、亮、低对比度、高对比度

* 直方图是图像处理领域中的一个重要工具，也可以用于图像增强。从前面的分析可知，一般情况下若是图像的直方图成**均匀分布态势**，则图像的**对比度较高**且有比较**丰富的灰度色调**。这就为我们提供了一种基于直方图的图像增强处理方法。也就是说为了达到好的图像效果,可寻求一种变换：
  $$
  s =T (r),0\leq r\leq L-1
  $$
  使得变换后的图像具有（尽可能）均匀分布的直方图。

* 均衡化步骤：灰度级：$r_k$，变换函数：$s_k$，$k=0,1,2,...,L-1$

  1. 计算**概率**：$p_r(r_k)=\dfrac{n_k}{n}$
  2. 计算**累积分布函数**：$P(r_k)=\sum\limits^k_{j=0}p_r(r_j)=\sum\limits^k_{j=0}\dfrac{n_j}{n}$
  3. **变换函数**：$s_k=T(r_k)=(L-1)\times\sum\limits^k_{j=0}\dfrac{n_j}{n}$
  4. 将$s_k$ “四舍五入” 转换为标准灰度级别，如果有相同的$\lceil s_k\rceil$，则合并。

* 直方图均衡化方法用于图像增强有一个最大的特点：自动化，有强大的适应性强的功能。



## 3 Assignment

1. 做出一个图像的直方图，将之均衡化。
2. 做一个gamma变化，把一个暗的图像变亮、或将亮的图像变暗。 

